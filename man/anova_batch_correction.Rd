% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/winn.R
\name{anova_batch_correction}
\alias{anova_batch_correction}
\title{Perform ANOVA-based Mean-Only Batch Correction}
\usage{
anova_batch_correction(data, batch, fdr_threshold = 0.05)
}
\arguments{
\item{data}{A numeric matrix (metabolites Ã— samples).}

\item{batch}{A factor or numeric vector indicating batch for each sample.}

\item{fdr_threshold}{Significance threshold for FDR-adjusted p-values.}
}
\value{
A numeric matrix of corrected intensities.
}
\description{
This function runs an ANOVA test on each metabolite to detect batch effects,
and then corrects significant batch effects by subtracting the estimated
batch-specific shifts (while preserving the overall mean).
}
\examples{
mat <- matrix(rnorm(200, mean = 100, sd = 15), nrow=20)
batch <- rep(1:4, length.out=ncol(mat))
corrected <- anova_batch_correction(mat, batch, fdr_threshold=0.05)
}
