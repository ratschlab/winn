% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/winn.R
\name{combat_batch_correction}
\alias{combat_batch_correction}
\title{Perform ComBat Batch Correction by batch}
\usage{
combat_batch_correction(
  data,
  batch,
  par_prior = TRUE,
  mean_only = FALSE,
  ref_batch = NULL
)
}
\arguments{
\item{data}{A numeric matrix (metabolites Ã— samples).}

\item{batch}{A factor or numeric vector indicating batch for each sample.}

\item{par_prior}{Logical indicating whether to use parametric prior (default TRUE).}

\item{mean_only}{Logical indicating mean-only adjustment (default FALSE).}

\item{ref_batch}{Optional reference batch level for anchoring (default NULL).}
}
\value{
A numeric matrix of corrected intensities.
}
\description{
This function applies the empirical Bayes ComBat method to correct batch effects
by batch, adjusting both location and scale parameters across batch.
}
\examples{
mat <- matrix(rnorm(200, mean = 100, sd = 15), nrow=20)
batch <- rep(1:4, length.out=ncol(mat))
corrected <- combat_batch_correction(mat, batch, par_prior = TRUE)
}
